Para esse tutorial, usaremos o conjunto de dados disponibilizado pelo governo do Estado de São Paulo sobre o número de casos de COVID-19 em indígenas desde o início da pandemia. Trata-se do mesmo conjunto trabalhado no <i> <a href="https://github.com/biafarrugia/Jornalismo_de_Dados_FAAP/blob/main/Tutorial%20de%20limpeza%20de%20dados%20usando%20o%20Google%20Sheets.md"> Tutorial de limpeza de dados usando o Google Sheets</a> </i>. Para acessar os dados extraídos e limpos, <a href="https://docs.google.com/spreadsheets/d/1qPqoMIhYfk6YM20AlMv5-TRyHJ75x2pGCJSZKlWCCU4/edit?usp=sharing"> clique aqui. </a> 
<p> A análise de dados é a etapa durante a qual são utilizados funções e cálculos matemáticos para interpretar, compreender e gerar insights sobre determinado assunto. Através da análise, é possível descobrir padrões, tendências e correlação entre os dados. 
<p> Antes de iniciar a análise de dados, no entanto, é muito importante que você saiba que tipo de informação está procurando naquele determinado conjunto de dados. Isso te ajudará a manter o foco e ser objetivo. Como um conjunto de dados pode oferecer inúmeros insights e histórias, é muito fácil se perder no meio de tantas informações. A minha recomendação é que você gaste alguns minutos dando uma olhada prévia em seu conjunto de dados e escrevendo em um papel quais perguntas gostaria que fossem respondidas pelos dados. Tente também refletir sobre como será a estrutura e formato da sua reportagem (<a href="https://onlinejournalismblog.com/2021/06/08/os-angulos-mais-usados-por-jornalistas-para-contar-historias-com-dados/"> os 7 ângulos mais usados no jornalismo de dados, de Paul Bradshaw</a>, são extremamente úteis nessa reflexão). 
<p> <b> 1. </b> Para iniciar o tutorial, acesse <a href="https://docs.google.com/spreadsheets/d/1qPqoMIhYfk6YM20AlMv5-TRyHJ75x2pGCJSZKlWCCU4/edit?usp=sharing"> essa planilha</a> e  faça uma cópia dela em seu drive pessoal do Google. No menu superior da planilha, clique em <b> Arquivo> Fazer uma Cópia</b>.
<p> <b> 2. </b> Gaste 5 minutos refletindo sobre quais informações podem ser extraídas desse conjunto de dados e sobre qual formato sua reportagem final terá. Minha sugestão é tentarmos responder aos seguintes questionamentos: 
  <p> a. Quantos casos de COVID-19 foram registrados em indígenas do Estado de São Paulo?
  <p> b. Em quantos municípios houve registro de casos positivos para COVID-19?
  <p> c. Qual é o município com maior número de casos totais de COVID-19 em indígenas? <i> Caso você queira fazer uma análise mais detalhada e precisa, seria possível calcular a taxa de casos positivos em relação à população indígena. Mas, para isso, você precisaria fazer uma pesquisa para obter os dados populacionais. </i>
  <p> d. Quantas são as etnias indígenas que aparecem no levantantamento de dados do governo do Estado de São Paulo? E quais são essas etnias? <i> Repare que, como muitos dados de etnias não foram informados, seria imprudente fazer qualquer análise comparativa sobre a incidência de casos de COVID-19 por etnias indígenas, como, por exemplo: "Qual etnia indígena registrou mais casos de COVID-19 durante toda a pandemia?". </i>
<p> <b> 3. </b>  Essas 4 perguntas são apenas alguns exemplos de análises que podem ser feitas com esse conjunto de dados em específico. Dependendo da reportagem que você for criar, será necessário fazer outros tipos de análises e até obter dados extras, como os populacionais.
<p> <b> 4. </b> A seguir, vou mostrar a você como responderemos cada uma das 4 perguntas listadas acima aplicando funções e cálculos no Google Sheets. Afinal, o objetivo desse tutorial é que você treine, na prática, a aplicação dessas operações:
   <p> <b> a. Quantos casos de COVID-19 foram registrados em indígenas do Estado de São Paulo? </b>
<p> Para responder a essa pergunta, precisaremos <b> SOMAR </b> os casos listados na planilha. Usaremos a função <b> SUM</b> para isso. Portanto, selecione a célula <b> D140 </b> (ou seja, o espaço em branco na intersecção da linha 140 com a coluna D, onde estão os números de casos de COVID-19). Dê dois cliques na célula em branco e insira o sinal de <b> = </b>, necessário para ativar as funções dentro do Google Sheets. Digite <b> =SUM(D2:D139) </b>. O D2:D:139 significa que é para somar tudo que estiver entre as linhas 2 e 139 da coluna D. Ao apertar ENTER, a célula D140 deverá exibir o resultado da soma, <b> 303</b>.
   <p> <b> b. Em quantos municípios houve registro de casos positivos para COVID-19? </b>
  <p> Para responder a essa pergunta, precisaremos olhar para a coluna A, onde estão os registros de municípios. Repare que um município pode aparecer mais de uma vez na lista, pois cada confirmação de caso de coronavírus é anotada como uma nova linha nessa tabela. Para calcular quantos municípios registraram casos positivos, precisaremos excluir as duplicidades. Por exemplo: o município de Arco-Íris aparece quatro vezes na planilha, mas iremos contar apenas como um registro. Para isso, precisaremos aplicar comandos do Google Sheets que retiram as duplicidades. Existem várias formas de se fazer isso: uma delas é selecionando a coluna A, onde estão as informações de municípios, e acessando o menu superior em <b> Dados>Limpeza de Dados>Remover Cópias </b>. Esse comando remove os registros duplicados (as cópias). Apesar de ser um comando rápido e eficiente, nós não vamos seguir com essa opção, pois, como você deve ter notado, ela apaga os registros da planilha, o que pode comprometer o entendimento dos dados quando formos olhar para as colunas B, C e D. 
    <p> Para preservar a estrutura dos dados, vamos seguir por outro caminho. Sugiro que você selecione a coluna A, aperte <b> CTRL+C</b> para copiar os dados, crie uma nova aba no seu arquivo, ao lado de onde está escrito <b> Página 1 </b>, e cole o conteúdo na coluna A da nova planilha usando o comando <b> CTRL+V</b>. Nesse momento, seu arquivo deverá conter: a Página 1, com a  planilha que estávamos trabalhando, e a Página 2, apenas com os dados de município na coluna A. Na aba da Página 2, iremos aplicar o comando mencionado anteriormente <b> Dados>Limpeza de Dados>Remover Cópias </b>. Como resultado, você obterá uma lista com o cabeçalho <b>Município</b> e mais 110 linhas com nomes de municípios, sem nenhuma duplicidade.
<p> Outro comando que pode ser usado para remover duplicidades no Google Sheets é o <b>=COUNTUNIQUE</b>. Ele extrai apenas os valores e registros únicos em um intervalo de dados. Para testá-lo, sugiro que você retorne à Página 1 e selecione a célula <b> A140</b>. Aplique o seguinte comando: <b>=COUNTUNIQUE(A2:A139)</b>, onde (A2:A139) são as indicações para o comando contar quantos são os registros únicos (sem duplicidades) do intervalo A2 e A139, referentes à coluna A dos municípios. 
<p> A reposta para essa pergunta, então, é <b> 110 municípios</b>.
<p> <b> c. Qual é o município com maior número de casos totais de COVID-19 em indígenas? </b> 
Para respondermos a essa pergunta, precisaremos somar os casos positivos por cidades. Já sabemos que temos 110 municípios diferentes nessa planilha. Portanto, precisaremos descobrir qual o total de casos em cada um deles. Para isso, vamos criar uma nova coluna na célula <b>E1</b>, nomeando-a como "Municípios sem duplicidade". Na célula <b>E2<b/>, insira a seguinte função <b>=UNIQUE(A2:A139)</b>. Ela trará os 110 municípíos, sem repetição de nomes. O comando dessa função funciona da seguinte maneira: Exiba os registros únicos (unique) do intervalo A2 até A139, correspondente à coluna A, onde estão todos os municípios.
  <p> Agora, vamos criar uma nova coluna. Dessa vez, na célula <b>F1<b/>, dando o nome de "Contagem de casos totais por municípios". É aqui que faremos a soma de casos de COVID-19 de cada município. Selecione a célula <b>F2</b> e aplique a seguinte fórmula: <b> =SUMIF(A2:A149;E2;D2:D149) </b>. A função SUMIF, do inglês "Soma SE", faz a soma de valores de acordo com uma circunstância que iremos definir. Nesse caso, nós definimos com o parâmetro (A2:A149;E2;D2:D149) que era para somar os valores encontrados nos intervalos A2:A149 (dos municípios) e D2:D149 (dos casos de COVID-19), organizando-os por município (E2). Toda vez que você for usar uma função no Google Sheets, é possível clicar no ícone "i", onde terá mais informações sobre os parâmetros. Para uma função funcionar corretamente, você deve seguir a ordem exigida pelo Google Sheets. No caso da função SUMIF, as orientações eram: "SUMIF(intervalo; criterio; [intervalo_da_soma])".  Sendo que nosso intervalo era a Coluna A, ou seja, A2:A149; o critério era o nome único de cada município, ou seja, a coluna E2 que foi criada recentemente; e o intervalo da soma se refere à coluna D, ou seja, D2:D149.
  Ordenar por:
   <p> 
  
<p> <b> Bônus:</b>
<p> Você não precisa se esforçar para memorizar todas as funções do Google Sheets. Existem centenas de tutoriais na web que você pode consultar toda vez que quiser realizar uma operação. Apenas busque por "como fazer algo XXX no Google Sheets" e veja como executar as funções.
