# Raspagem de dados usando o Google Sheets

<br> O web scraping (raspagem de dados) é uma técnica para coletar tabelas e dados de uma página na web. É utilizada em situações nas quais não há bases de dados estruturadas sobre determinado assunto, sendo necessário coletar esses dados em um ou mais sites. 
<br> A raspagem pode ser feita de diversas maneiras: através de linguagens de programação (como Python), de softwares específicos de raspagem de dados ou do Google Sheets (Google Planilhas). 
<br> Nesse tutorial, vou ensinar você a fazer uma raspagem simples de dados pelo Google Sheets. Para isso, não será necessário dominar linguagens de programação nem baixar softwares no seu computador. Você precisará apenas ter uma conta no Google. 

<br> <i> Etapas </i>
<p> <b> 1. </b> Faça login na conta do Google e acesse o <a href="https://www.google.com/sheets/about/"> Google Sheets</a>.
<p> <b> 2. </b> Crie uma nova planilha, com células em branco. 
<p> <b> 3. </b> Posicione seu mouse em cima da céula A1, logo no início da planilha. 
<p> <b> 4. </b> Digite o comando <b> =IMPORTHTML </b>. Esse é um comando utilizado para importar elementos HTML de páginas na web. Ele é composto por três parâmetros (os parâmetros são como ingredientes em uma receita: você precisa preenchê-los para que a operação funcione), que são: “LINK”; “TIPO”; NÚMERO. O  link se refere ao endereço (URL) da página na web da qual você quer extrair o dado. O tipo é a especificação do tipo de elemento que você quer importar. E o número se refere à posição em que esse elemento está na página.
<p> <b> 5. </b> Nesse tutorial, vamos "raspar" uma página do Wikipedia em que há uma <a href="https://pt.wikipedia.org/wiki/Lista_de_entradas_brasileiras_na_Billboard_Hot_100 "> lista de 22 músicas brasileiras que apareceram nas paradas de sucesso da Billboard </a>. Se você fosse copiar essa lista manualmente, provavelmente selecionaria toda a tabela e usaria os comandos de "Copiar" e "Colar", transferindo o conteúdo para uma planilha ou arquivo em branco. Mas, com o IMPORTHTML, você pode fazer isso de maneira automática e mantendo a configuração das linhas e colunas da tabela. 
<p> <b> 6. </b> Na célula A1, insira o <b> =IMPORTHTML </b> e preencha os seus parâmetros com o link https://pt.wikipedia.org/wiki/Lista_de_entradas_brasileiras_na_Billboard_Hot_100, a especificação TABLE (pois estamos importando um elemento tabela) e o número 1 (já que se trata da primeira tabela da página). Sua fórmula ficará exatamente assim: <b> =IMPORTHTML("https://pt.wikipedia.org/wiki/Lista_de_entradas_brasileiras_na_Billboard_Hot_100"; "table"; "1") </b>
<p> <b> 7. </b>  É importante notar que os parâmetros precisam estar entre aspas e separados por ponto e vírgula. No entanto, em algumas versões do Google Sheets, pode ser que os separadores sejam aspas simples e apenas vírgula. Vale testar as duas formas. 
 <p> <b> 8. </b> Assim que preencher todos os parâmetros, dê "ENTER". Sua planilha deverá carregar exatamente os dados contidos na lista exibida na Wikipedia. Repare que a célula A1 permanecerá vazia ou apenas com o sinal <i> # </i>, pois é lá que a fórmula do IMPORTHTML ficará armazenada.  Confira o resultado final <a href="https://docs.google.com/spreadsheets/d/1NBn_1QWkXTuJC89zgy44MJj3ppOx2B18FucmfL6NXZ0/edit?usp=sharing"> aqui</a>.
 <p> <b> 9. </b> Você pode aplicar esse comando toda vez que quiser importar um elemento, de preferência uma tabela, de uma página HTML. Além dessa, o Google Sheets possui outras três funções úteis para raspagem de dados: a <b> =IMPORTDATA </b> , <b> =IMPORTFEED</b> e <b> =IMPORTXML </b>. Você pode conferir mais detalhes sobre essas funções assistindo <a href="https://www.youtube.com/watch?v=Q5yVoTqD06M"> a esse vídeo. </a> 
